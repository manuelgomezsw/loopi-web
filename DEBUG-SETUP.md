# üêõ Configuraci√≥n de Debugging - Loopi Web

## üìã **Configuraci√≥n Completa Implementada**

### ‚úÖ **Source Maps y Build**

- Source maps habilitados para desarrollo
- Configuraci√≥n optimizada para debugging
- Build no optimizado en development

### ‚úÖ **VSCode/Cursor Debugging**

- Configuraci√≥n completa de launch.json
- Tasks para ng serve, build, test
- Configuraciones recomendadas de extensiones

### ‚úÖ **Environment Variables**

- Variables espec√≠ficas para debugging
- Feature flags para desarrollo
- Configuraci√≥n de logging por niveles

### ‚úÖ **Servicios de Debugging**

- DebugService para logging estructurado
- Debug interceptor para HTTP requests
- Utilities y decorators para debugging

## üöÄ **C√≥mo Usar el Sistema de Debugging**

### 1. **Inicio R√°pido**

#### Opci√≥n A: VSCode/Cursor Debugging

1. Abrir Command Palette (`Cmd+Shift+P`)
2. Ejecutar `Debug: Start Debugging`
3. Seleccionar `üöÄ Launch Angular App`
4. La aplicaci√≥n iniciar√° con debugging habilitado

#### Opci√≥n B: Terminal

```bash
# Desarrollo con debugging
npm start

# Desarrollo con debugging detallado
ng serve --configuration=development --verbose
```

### 2. **Herramientas Disponibles en el Browser**

#### Console Global de Debug

Una vez iniciada la aplicaci√≥n, tienes acceso a herramientas globales:

```javascript
// Acceso al servicio de debug
window.debug.service;

// Ver todos los logs
window.debug.logs();

// Ver logs filtrados
window.debug.logs().filter((log) => log.level === "error");

// Limpiar logs
window.debug.clear();

// Exportar logs como JSON
window.debug.export();

// Ver informaci√≥n de performance
window.debug.performance();

// Ver configuraci√≥n de environment
window.debug.environment;
```

#### Componentes Registrados

```javascript
// Ver componentes registrados para debugging
window.components;

// Acceder a un componente espec√≠fico
window.components.LoginFormComponent;
```

### 3. **DebugService - Logging Estructurado**

#### Uso B√°sico

```typescript
import { DebugService } from './core/services/debug/debug.service';

constructor(private debug: DebugService) {}

// Diferentes niveles de log
this.debug.debug('AuthService', 'User login attempt', { email: user.email });
this.debug.info('AuthService', 'Login successful');
this.debug.warn('AuthService', 'Token expiring soon');
this.debug.error('AuthService', 'Login failed', error);
```

#### Medici√≥n de Performance

```typescript
// Medir operaci√≥n sincr√≥nica
const result = this.debug.measurePerformance(
  "AuthService",
  "validateToken",
  () => {
    return this.validateToken(token);
  }
);

// Medir operaci√≥n as√≠ncrona
const result = await this.debug.measurePerformanceAsync(
  "AuthService",
  "loginUser",
  async () => {
    return this.http.post("/login", credentials).toPromise();
  }
);
```

### 4. **Decorators para Debugging**

#### @LogMethod - Logging Autom√°tico

```typescript
import { LogMethod } from "./core/utils/debug.utils";

export class AuthService {
  @LogMethod("AuthService")
  login(credentials: LoginCredentials) {
    // Se loggea autom√°ticamente la entrada y salida
    return this.http.post("/auth/login", credentials);
  }
}
```

#### @TrackPerformance - Monitoreo de Performance

```typescript
import { TrackPerformance } from "./core/utils/debug.utils";

export class DataService {
  @TrackPerformance(500) // Alerta si toma m√°s de 500ms
  processLargeDataset(data: any[]) {
    return this.complexOperation(data);
  }
}
```

### 5. **Debugging de Componentes**

#### Registro de Componentes

```typescript
import { ComponentDebugger } from "./core/utils/debug.utils";

export class LoginFormComponent implements OnInit {
  ngOnInit() {
    // Registrar componente para debugging global
    ComponentDebugger.getInstance().registerComponent("LoginForm", this);
  }
}
```

#### Directiva de Debug Info

```html
<!-- Mostrar informaci√≥n de debugging en el DOM -->
<div appDebugInfo="LoginForm" [debugData]="form.value">
  <!-- Contenido del componente -->
</div>
```

### 6. **Debugging de Estados y Formularios**

#### Estado

```typescript
import { StateDebugger } from "./core/utils/debug.utils";

// Comparar estados
StateDebugger.diffStates(oldState, newState, "UserState");
```

#### Formularios

```typescript
import { FormDebugger } from "./core/utils/debug.utils";

// Debug completo de formulario
FormDebugger.debugForm(this.loginForm, "LoginForm");
```

### 7. **HTTP Request Debugging**

El `debugInterceptor` logea autom√°ticamente:

- ‚úÖ Todas las requests salientes
- ‚úÖ Responses con timing
- ‚úÖ Errores HTTP detallados
- ‚úÖ Performance warnings para requests lentas
- ‚úÖ Headers (sin informaci√≥n sensible)

#### Ejemplo de Log

```
[HTTP:Request] POST /auth/login
{
  requestId: "req_1234567890_abc123",
  method: "POST",
  url: "/auth/login",
  headers: { "content-type": "application/json" },
  body: { email: "user@example.com", password: "[REDACTED]" }
}

[HTTP:Response] POST /auth/login - 200
{
  requestId: "req_1234567890_abc123",
  status: 200,
  duration: "245.67ms",
  bodySize: "1.2 KB"
}
```

## üîß **Configuraci√≥n de VSCode/Cursor**

### Launch Configurations Disponibles:

- üöÄ **Launch Angular App**: Inicia la app con debugging
- üîç **Attach to Chrome**: Se conecta a Chrome ya ejecut√°ndose
- üß™ **Debug Angular Tests**: Debugging de unit tests
- üîß **Debug Node**: Para scripts de build

### Tasks Disponibles:

- **ng-serve**: Servidor de desarrollo
- **ng-test**: Ejecutar tests
- **ng-build-dev**: Build de desarrollo
- **ng-lint**: Linting del c√≥digo
- **üßπ Clean & Rebuild**: Limpia y reconstruye

## üìä **Environment Flags**

### Development (environment.ts)

```typescript
enableDebugMode: true           // Habilita todas las herramientas
enableConsoleLogging: true      // Logs en console
enableDetailedErrors: true      // Stack traces completos
enablePerformanceLogging: true  // M√©tricas de performance
features.showDebugInfo: true    // Info visual en componentes
```

### Production (environment.prod.ts)

```typescript
enableDebugMode: false; // Deshabilitado en producci√≥n
enableConsoleLogging: false; // Solo errores cr√≠ticos
enableDetailedErrors: false; // Errores gen√©ricos
enablePerformanceLogging: false; // Sin m√©tricas
```

## üéØ **Breakpoints y Debugging**

### En el C√≥digo TypeScript:

1. Colocar breakpoints directamente en VSCode/Cursor
2. Iniciar debugging con `F5` o `üöÄ Launch Angular App`
3. La aplicaci√≥n se pausar√° en los breakpoints

### En el Browser:

1. Abrir DevTools (`F12`)
2. Ir a Sources tab
3. Los archivos TypeScript originales est√°n disponibles
4. Colocar breakpoints directamente

### En Tests:

1. Usar configuraci√≥n `üß™ Debug Angular Tests`
2. Breakpoints funcionan en archivos `.spec.ts`

## üìà **Performance Monitoring**

### M√©tricas Autom√°ticas:

- Timing de HTTP requests
- Tiempo de ejecuci√≥n de m√©todos decorados
- Performance marks en el browser
- Memory usage (cuando est√© disponible)

### Manual:

```typescript
// Marcar puntos en el timeline
this.debug.mark("operation-start");
// ... operaci√≥n
this.debug.mark("operation-end");
this.debug.measure("operation-total", "operation-start", "operation-end");
```

## üö® **Troubleshooting**

### Si no aparecen source maps:

1. Verificar que `sourceMap: true` en angular.json
2. Reiniciar el servidor de desarrollo
3. Limpiar cache del browser

### Si no funciona el debugging en VSCode:

1. Verificar que Chrome est√© cerrado antes de iniciar
2. Verificar puerto 4200 est√© libre
3. Instalar Chrome extension para debugging

### Si no aparecen logs:

1. Verificar `environment.enableDebugMode = true`
2. Verificar nivel de logging en environment
3. Abrir console del browser (`F12`)

## üîÑ **Pr√≥ximos Pasos**

1. **Angular DevTools**: Instalar extensi√≥n de Chrome
2. **Error Tracking**: Integrar Sentry/LogRocket en producci√≥n
3. **Performance Monitoring**: Configurar m√©tricas autom√°ticas
4. **E2E Debugging**: Configurar Cypress/Playwright

¬°La configuraci√≥n de debugging est√° lista! Ahora tienes todas las herramientas necesarias para desarrollar y debuggear eficientemente.
